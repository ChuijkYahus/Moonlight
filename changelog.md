some new API improvements, ported changes from 1.20.1